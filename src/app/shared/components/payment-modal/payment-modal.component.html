<!-- Payment Modal - Matching Figma Exactly -->
@if (isOpen()) {
  <div class="payment-modal-overlay" (click)="onBackdropClick($event)">
    <div class="payment-modal">
      <!-- Header -->
      <div class="payment-modal__header">
        <h2 class="payment-modal__title">PAYMENT</h2>
        <button class="payment-modal__close" (click)="onClose()">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
            <path d="M18 6L6 18M6 6L18 18" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
          </svg>
        </button>
      </div>

      <!-- Payment Tabs -->
      <div class="payment-tabs">
        <button 
          class="payment-tabs__tab" 
          [class.active]="activeTab() === 'card'"
          (click)="setActiveTab('card')">
          Card Payment
        </button>
        <button 
          class="payment-tabs__tab" 
          [class.active]="activeTab() === 'upi'"
          (click)="setActiveTab('upi')">
          UPI Payment
        </button>
        <button 
          class="payment-tabs__tab" 
          [class.active]="activeTab() === 'netbanking'"
          (click)="setActiveTab('netbanking')">
          Net Banking
        </button>
      </div>

      <!-- Tab Content -->
      <div class="payment-modal__content">
        @if (activeTab() === 'card') {
          <div class="card-payment-form">
            <!-- Card Number -->
            <div class="form-group">
              <label class="form-label">Card Number</label>
              <input 
                type="text" 
                class="form-input"
                placeholder="1234 5678 9012 3456"
                [value]="cardNumber()"
                (input)="formatCardNumber($event)"
                maxlength="19"
              />
            </div>

            <!-- Cardholder Name -->
            <div class="form-group">
              <label class="form-label">Cardholder Name</label>
              <input 
                type="text" 
                class="form-input"
                placeholder="John Doe"
                [value]="cardholderName()"
                (input)="cardholderName.set($any($event.target).value)"
              />
            </div>

            <!-- Expiry and CVV Row -->
            <div class="form-row">
              <div class="form-group">
                <label class="form-label">Expiry Date</label>
                <input 
                  type="text" 
                  class="form-input"
                  placeholder="MM/YY"
                  [value]="expiryDate()"
                  (input)="formatExpiryDate($event)"
                  maxlength="5"
                />
              </div>
              <div class="form-group">
                <label class="form-label">CVV</label>
                <input 
                  type="password" 
                  class="form-input"
                  placeholder="123"
                  [value]="cvv()"
                  (input)="formatCvv($event)"
                  maxlength="3"
                />
              </div>
            </div>

            <!-- Security Note -->
            <div class="security-note">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
                <rect x="3" y="11" width="18" height="11" rx="2" stroke="currentColor" stroke-width="1.5"/>
                <path d="M7 11V7C7 4.23858 9.23858 2 12 2C14.7614 2 17 4.23858 17 7V11" stroke="currentColor" stroke-width="1.5"/>
              </svg>
              <span>Your card details are encrypted and secure</span>
            </div>
          </div>
        } @else if (activeTab() === 'upi') {
          <div class="upi-payment-form">
            <div class="form-group">
              <label class="form-label">UPI ID</label>
              <input 
                type="text" 
                class="form-input"
                placeholder="yourname@upi"
              />
            </div>
            <p class="upi-info">Enter your UPI ID to receive payment request</p>
          </div>
        } @else if (activeTab() === 'netbanking') {
          <div class="netbanking-form">
            <p class="netbanking-info">Select your bank to proceed with payment</p>
            <div class="bank-list">
              <button class="bank-option">HDFC Bank</button>
              <button class="bank-option">ICICI Bank</button>
              <button class="bank-option">SBI</button>
              <button class="bank-option">Axis Bank</button>
            </div>
          </div>
        }
      </div>

      <!-- Pay Button -->
      <button 
        class="payment-modal__pay-btn"
        [disabled]="!isFormValid() || isProcessing()"
        (click)="processPayment()">
        @if (isProcessing()) {
          <span class="spinner"></span>
          Processing...
        } @else {
          Pay â‚¹{{ totalAmount() | number:'1.2-2' }}
        }
      </button>
    </div>
  </div>
}
